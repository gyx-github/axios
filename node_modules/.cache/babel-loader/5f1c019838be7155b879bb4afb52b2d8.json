{"remainingRequest":"/Users/yanxugong/Workspace/01 Code/file-upload/node_modules/babel-loader/lib/index.js!/Users/yanxugong/Workspace/01 Code/file-upload/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yanxugong/Workspace/01 Code/file-upload/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yanxugong/Workspace/01 Code/file-upload/src/views/Upload.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yanxugong/Workspace/01 Code/file-upload/src/views/Upload.vue","mtime":1581566766788},{"path":"/Users/yanxugong/Workspace/01 Code/file-upload/node_modules/cache-loader/dist/cjs.js","mtime":1580041481289},{"path":"/Users/yanxugong/Workspace/01 Code/file-upload/node_modules/babel-loader/lib/index.js","mtime":1574436104827},{"path":"/Users/yanxugong/Workspace/01 Code/file-upload/node_modules/cache-loader/dist/cjs.js","mtime":1580041481289},{"path":"/Users/yanxugong/Workspace/01 Code/file-upload/node_modules/vue-loader/lib/index.js","mtime":1580041499935}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZWR1Y2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIudG8tZml4ZWQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy95YW54dWdvbmcvV29ya3NwYWNlLzAxIENvZGUvZmlsZS11cGxvYWQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX3NsaWNlZFRvQXJyYXkgZnJvbSAiL1VzZXJzL3lhbnh1Z29uZy9Xb3Jrc3BhY2UvMDEgQ29kZS9maWxlLXVwbG9hZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCnZhciBTSVpFID0gMTAgKiAxMDI0ICogMTAyNDsgLy8g5YiH54mH5aSn5bCPCgp2YXIgU3RhdHVzID0gewogIHdhaXQ6ICd3YWl0JywKICBwYXVzZTogJ3BhdXNlJywKICB1cGxvYWRpbmc6ICd1cGxvYWRpbmcnCn07CmV4cG9ydCBkZWZhdWx0IHsKICBmaWx0ZXJzOiB7CiAgICB0cmFuc2Zvcm1CeXRlOiBmdW5jdGlvbiB0cmFuc2Zvcm1CeXRlKHZhbCkgewogICAgICByZXR1cm4gTnVtYmVyKCh2YWwgLyAxMDI0KS50b0ZpeGVkKDApKTsKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBTdGF0dXM6IFN0YXR1cywKICAgICAgY29udGFpbmVyOiB7CiAgICAgICAgZmlsZTogbnVsbCwKICAgICAgICBoYXNoOiAnJywKICAgICAgICB3b3JrZXI6IG51bGwKICAgICAgfSwKICAgICAgaGFzaFBlcmNlbnRhZ2U6IDAsCiAgICAgIGRhdGE6IFtdLAogICAgICByZXF1ZXN0TGlzdDogW10sCiAgICAgIHN0YXR1czogU3RhdHVzLndhaXQsCiAgICAgIC8vIOW9k+aaguWBnOaXtuS8muWPlua2iCB4aHIg5a+86Ie06L+b5bqm5p2h5ZCO6YCACiAgICAgIC8vIOS4uuS6humBv+WFjei/meenjeaDheWGte+8jOmcgOimgeWumuS5ieS4gOS4quWBh+eahOi/m+W6puadoQogICAgICBmYWtlVXBsb2FkUGVyY2VudGFnZTogMAogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICB1cGxvYWRQZXJjZW50YWdlOiBmdW5jdGlvbiB1cGxvYWRQZXJjZW50YWdlKG5ld1ZhbHVlKSB7CiAgICAgIGlmIChuZXdWYWx1ZSA+IHRoaXMuZmFrZVVwbG9hZFBlcmNlbnRhZ2UpIHsKICAgICAgICB0aGlzLmZha2VVcGxvYWRQZXJjZW50YWdlID0gbmV3VmFsdWU7CiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICB1cGxvYWREaXNhYmxlZDogZnVuY3Rpb24gdXBsb2FkRGlzYWJsZWQoKSB7CiAgICAgIHJldHVybiAhdGhpcy5jb250YWluZXIuZmlsZSB8fCBbU3RhdHVzLnBhdXNlLCBTdGF0dXMudXBsb2FkaW5nXS5pbmNsdWRlcyh0aGlzLnN0YXR1cyk7CiAgICB9LAogICAgdXBsb2FkUGVyY2VudGFnZTogZnVuY3Rpb24gdXBsb2FkUGVyY2VudGFnZSgpIHsKICAgICAgaWYgKCF0aGlzLmNvbnRhaW5lci5maWxlIHx8ICF0aGlzLmRhdGEubGVuZ3RoKSByZXR1cm4gMDsKICAgICAgdmFyIGxvYWRlZCA9IHRoaXMuZGF0YS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5zaXplICogaXRlbS5wZXJjZW50YWdlOwogICAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgY3VyKSB7CiAgICAgICAgcmV0dXJuIGFjYyArIGN1cjsKICAgICAgfSk7CiAgICAgIHJldHVybiBwYXJzZUludCgobG9hZGVkIC8gdGhpcy5jb250YWluZXIuZmlsZS5zaXplKS50b0ZpeGVkKDIpKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGhhbmRsZVBhdXNlOiBmdW5jdGlvbiBoYW5kbGVQYXVzZSgpIHsKICAgICAgdGhpcy5zdGF0dXMgPSBTdGF0dXMucGF1c2U7CiAgICAgIHRoaXMucmVzZXREYXRhKCk7CiAgICB9LAogICAgcmVzZXREYXRhOiBmdW5jdGlvbiByZXNldERhdGEoKSB7CiAgICAgIHRoaXMucmVxdWVzdExpc3QuZm9yRWFjaChmdW5jdGlvbiAoeGhyKSB7CiAgICAgICAgcmV0dXJuIHhociA9PT0gbnVsbCB8fCB4aHIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHhoci5hYm9ydCgpOwogICAgICB9KTsKICAgICAgdGhpcy5yZXF1ZXN0TGlzdCA9IFtdOwoKICAgICAgaWYgKHRoaXMuY29udGFpbmVyLndvcmtlcikgewogICAgICAgIHRoaXMuY29udGFpbmVyLndvcmtlci5vbm1lc3NhZ2UgPSBudWxsOwogICAgICB9CiAgICB9LAogICAgcmVxdWVzdDogZnVuY3Rpb24gcmVxdWVzdChfcmVmKSB7CiAgICAgIHZhciB1cmwgPSBfcmVmLnVybCwKICAgICAgICAgIF9yZWYkbWV0aG9kID0gX3JlZi5tZXRob2QsCiAgICAgICAgICBtZXRob2QgPSBfcmVmJG1ldGhvZCA9PT0gdm9pZCAwID8gJ3Bvc3QnIDogX3JlZiRtZXRob2QsCiAgICAgICAgICBkYXRhID0gX3JlZi5kYXRhLAogICAgICAgICAgX3JlZiRoZWFkZXJzID0gX3JlZi5oZWFkZXJzLAogICAgICAgICAgaGVhZGVycyA9IF9yZWYkaGVhZGVycyA9PT0gdm9pZCAwID8ge30gOiBfcmVmJGhlYWRlcnMsCiAgICAgICAgICBfcmVmJG9uUHJvZ3Jlc3MgPSBfcmVmLm9uUHJvZ3Jlc3MsCiAgICAgICAgICBvblByb2dyZXNzID0gX3JlZiRvblByb2dyZXNzID09PSB2b2lkIDAgPyBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlOwogICAgICB9IDogX3JlZiRvblByb2dyZXNzLAogICAgICAgICAgcmVxdWVzdExpc3QgPSBfcmVmLnJlcXVlc3RMaXN0OwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICAgICAgeGhyLnVwbG9hZC5vbnByb2dyZXNzID0gb25Qcm9ncmVzczsKICAgICAgICB4aHIub3BlbihtZXRob2QsIHVybCk7CiAgICAgICAgT2JqZWN0LmtleXMoaGVhZGVycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICByZXR1cm4geGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCBoZWFkZXJzW2tleV0pOwogICAgICAgIH0pOwogICAgICAgIHhoci5zZW5kKGRhdGEpOwoKICAgICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIC8vIOWwhuivt+axguaIkOWKn+eahCB4aHIg5LuO5YiX6KGo5Lit5Yig6ZmkCiAgICAgICAgICBpZiAocmVxdWVzdExpc3QpIHsKICAgICAgICAgICAgdmFyIHhockluZGV4ID0gcmVxdWVzdExpc3QuZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0gPT09IHhocjsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJlcXVlc3RMaXN0LnNwbGljZSh4aHJJbmRleCwgMSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmVzb2x2ZSh7CiAgICAgICAgICAgIGRhdGE6IGUudGFyZ2V0LnJlc3BvbnNlCiAgICAgICAgICB9KTsKICAgICAgICB9OyAvLyDmmrTpnLLlvZPliY0geGhyIOe7meWklumDqAoKCiAgICAgICAgcmVxdWVzdExpc3QgJiYgcmVxdWVzdExpc3QucHVzaCh4aHIpOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDnlJ/miJDmlofku7bliIfniYcKICAgIGNyZWF0ZUZpbGVDaHVuazogZnVuY3Rpb24gY3JlYXRlRmlsZUNodW5rKGZpbGUpIHsKICAgICAgdmFyIHNpemUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IFNJWkU7CiAgICAgIHZhciBmaWxlQ2h1bmtMaXN0ID0gW107CiAgICAgIHZhciBzdW0gPSAwOyAvLyDlvZPmu6HotrPmnaHku7bml7bov5vlhaXlvqrnjq/vvIzov5vlhaXlvqrnjq/lkI7vvIzlvZPmnaHku7bkuI3mu6HotrPml7bvvIzot7Plh7rlvqrnjq8KCiAgICAgIHdoaWxlIChzdW0gPCBmaWxlLnNpemUpIHsKICAgICAgICBmaWxlQ2h1bmtMaXN0LnB1c2goewogICAgICAgICAgZmlsZTogZmlsZS5zbGljZShzdW0sIHN1bSArIHNpemUpCiAgICAgICAgfSk7CiAgICAgICAgc3VtICs9IHNpemU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmaWxlQ2h1bmtMaXN0OwogICAgfSwKICAgIC8vIOeUn+aIkOaWh+S7tiBoYXNoICh3ZWItd29ya2VyKQogICAgY2FsY3VsYXRlSGFzaDogZnVuY3Rpb24gY2FsY3VsYXRlSGFzaChmaWxlQ2h1bmtMaXN0KSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBkZWJ1Z2dlcjsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgLy8g5re75YqgIHdvcmtlciDlsZ7mgKcKICAgICAgICBfdGhpcy5jb250YWluZXIud29ya2VyID0gbmV3IFdvcmtlcignL2hhc2guanMnKTsKCiAgICAgICAgX3RoaXMuY29udGFpbmVyLndvcmtlci5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBmaWxlQ2h1bmtMaXN0OiBmaWxlQ2h1bmtMaXN0CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzLmNvbnRhaW5lci53b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHZhciBfZSRkYXRhID0gZS5kYXRhLAogICAgICAgICAgICAgIHBlcmNlbnRhZ2UgPSBfZSRkYXRhLnBlcmNlbnRhZ2UsCiAgICAgICAgICAgICAgaGFzaCA9IF9lJGRhdGEuaGFzaDsKICAgICAgICAgIF90aGlzLmhhc2hQZXJjZW50YWdlID0gcGVyY2VudGFnZTsKCiAgICAgICAgICBpZiAoaGFzaCkgewogICAgICAgICAgICByZXNvbHZlKGhhc2gpOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZUZpbGVDaGFuZ2U6IGZ1bmN0aW9uIGhhbmRsZUZpbGVDaGFuZ2UoZSkgewogICAgICB2YXIgX2UkdGFyZ2V0JGZpbGVzID0gX3NsaWNlZFRvQXJyYXkoZS50YXJnZXQuZmlsZXMsIDEpLAogICAgICAgICAgZmlsZSA9IF9lJHRhcmdldCRmaWxlc1swXTsKCiAgICAgIGlmICghZmlsZSkgcmV0dXJuOwogICAgICB0aGlzLnJlc2V0RGF0YSgpOyAvLyDlsIblvZPliY3nirbmgIHnmoRkYXRh6YeN572u5Li65Yid5aeL54q25oCBCgogICAgICBPYmplY3QuYXNzaWduKHRoaXMuJGRhdGEsIHRoaXMuJG9wdGlvbnMuZGF0YSgpKTsKICAgICAgdGhpcy5jb250YWluZXIuZmlsZSA9IGZpbGU7CiAgICB9LAogICAgY3JlYXRlUHJvZ3Jlc3NIYW5kbGVyOiBmdW5jdGlvbiBjcmVhdGVQcm9ncmVzc0hhbmRsZXIoaXRlbSkgewogICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHsKICAgICAgICBpdGVtLnBlcmNlbnRhZ2UgPSBwYXJzZUludChTdHJpbmcoZS5sb2FkZWQgLyBlLnRvdGFsICogMTAwKSk7CiAgICAgIH07CiAgICB9LAogICAgaGFuZGxlUmVzdW1lOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfaGFuZGxlUmVzdW1lID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgX3JlZjIsIHVwbG9hZGVkTGlzdDsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBTdGF0dXMudXBsb2FkaW5nOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52ZXJpZnlVcGxvYWQodGhpcy5jb250YWluZXIuZmlsZS5uYW1lLCB0aGlzLmNvbnRhaW5lci5oYXNoKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgX3JlZjIgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgdXBsb2FkZWRMaXN0ID0gX3JlZjIudXBsb2FkZWRMaXN0OwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy51cGxvYWRDaHVua3ModXBsb2FkZWRMaXN0KTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGhhbmRsZVJlc3VtZSgpIHsKICAgICAgICByZXR1cm4gX2hhbmRsZVJlc3VtZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gaGFuZGxlUmVzdW1lOwogICAgfSgpLAogICAgaGFuZGxlVXBsb2FkOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfaGFuZGxlVXBsb2FkID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICAgIHZhciBmaWxlQ2h1bmtMaXN0LCBfcmVmMywgc2hvdWxkVXBsb2FkLCB1cGxvYWRlZExpc3Q7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBkZWJ1Z2dlcjsKCiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb250YWluZXIuZmlsZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBTdGF0dXMudXBsb2FkaW5nOwogICAgICAgICAgICAgICAgZmlsZUNodW5rTGlzdCA9IHRoaXMuY3JlYXRlRmlsZUNodW5rKHRoaXMuY29udGFpbmVyLmZpbGUpOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FsY3VsYXRlSGFzaChmaWxlQ2h1bmtMaXN0KTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIuaGFzaCA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZlcmlmeVVwbG9hZCh0aGlzLmNvbnRhaW5lci5maWxlLm5hbWUsIHRoaXMuY29udGFpbmVyLmhhc2gpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgX3JlZjMgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIHNob3VsZFVwbG9hZCA9IF9yZWYzLnNob3VsZFVwbG9hZDsKICAgICAgICAgICAgICAgIHVwbG9hZGVkTGlzdCA9IF9yZWYzLnVwbG9hZGVkTGlzdDsKCiAgICAgICAgICAgICAgICBpZiAoc2hvdWxkVXBsb2FkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn56eS5Lyg77ya5LiK5Lyg5oiQ5YqfJyk7CiAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFN0YXR1cy53YWl0OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gZmlsZUNodW5rTGlzdC5tYXAoZnVuY3Rpb24gKF9yZWY0LCBpbmRleCkgewogICAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IF9yZWY0LmZpbGU7CiAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgZmlsZUhhc2g6IF90aGlzMi5jb250YWluZXIuaGFzaCwKICAgICAgICAgICAgICAgICAgICBpbmRleDogaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgaGFzaDogIiIuY29uY2F0KF90aGlzMi5jb250YWluZXIuZmlsZS5uYW1lLCAiLSIpLmNvbmNhdChpbmRleCksCiAgICAgICAgICAgICAgICAgICAgLy8g5paH5Lu25ZCNICsg5pWw57uE5LiL5qCHCiAgICAgICAgICAgICAgICAgICAgY2h1bms6IGZpbGUsCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogZmlsZS5zaXplLAogICAgICAgICAgICAgICAgICAgIHBlcmNlbnRhZ2U6IHVwbG9hZGVkTGlzdC5pbmNsdWRlcyhpbmRleCkgPyAxMDAgOiAwCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy51cGxvYWRDaHVua3ModXBsb2FkZWRMaXN0KTsKCiAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGhhbmRsZVVwbG9hZCgpIHsKICAgICAgICByZXR1cm4gX2hhbmRsZVVwbG9hZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gaGFuZGxlVXBsb2FkOwogICAgfSgpLAogICAgLy8g5LiK5Lyg5YiH54mHCiAgICB1cGxvYWRDaHVua3M6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF91cGxvYWRDaHVua3MgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgICAgdmFyIHVwbG9hZGVkTGlzdCwKICAgICAgICAgICAgcmVxdWVzdExpc3QsCiAgICAgICAgICAgIF9hcmdzNCA9IGFyZ3VtZW50czsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdXBsb2FkZWRMaXN0ID0gX2FyZ3M0Lmxlbmd0aCA+IDAgJiYgX2FyZ3M0WzBdICE9PSB1bmRlZmluZWQgPyBfYXJnczRbMF0gOiBbXTsKICAgICAgICAgICAgICAgIHJlcXVlc3RMaXN0ID0gdGhpcy5kYXRhLmZpbHRlcihmdW5jdGlvbiAoX3JlZjUpIHsKICAgICAgICAgICAgICAgICAgdmFyIGhhc2ggPSBfcmVmNS5oYXNoOwogICAgICAgICAgICAgICAgICByZXR1cm4gIXVwbG9hZGVkTGlzdC5pbmNsdWRlcyhoYXNoKTsKICAgICAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbiAoX3JlZjYpIHsKICAgICAgICAgICAgICAgICAgdmFyIGNodW5rID0gX3JlZjYuY2h1bmssCiAgICAgICAgICAgICAgICAgICAgICBoYXNoID0gX3JlZjYuaGFzaCwKICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gX3JlZjYuaW5kZXg7CiAgICAgICAgICAgICAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2NodW5rJywgY2h1bmspOwogICAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2hhc2gnLCBoYXNoKTsKICAgICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlbmFtZScsIF90aGlzMy5jb250YWluZXIuZmlsZS5uYW1lKTsKICAgICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlSGFzaCcsIF90aGlzMy5jb250YWluZXIuaGFzaCk7CiAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgZm9ybURhdGE6IGZvcm1EYXRhLAogICAgICAgICAgICAgICAgICAgIGluZGV4OiBpbmRleAogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSkubWFwKAogICAgICAgICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICB2YXIgX3JlZjggPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAgICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhfcmVmNykgewogICAgICAgICAgICAgICAgICAgIHZhciBmb3JtRGF0YSwgaW5kZXg7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1EYXRhID0gX3JlZjcuZm9ybURhdGEsIGluZGV4ID0gX3JlZjcuaW5kZXg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgX3RoaXMzLnJlcXVlc3QoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBmb3JtRGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Qcm9ncmVzczogX3RoaXMzLmNyZWF0ZVByb2dyZXNzSGFuZGxlcihfdGhpczMuZGF0YVtpbmRleF0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0TGlzdDogX3RoaXMzLnJlcXVlc3RMaXN0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjguYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0oKSk7CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwocmVxdWVzdExpc3QpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBpZiAoISh1cGxvYWRlZExpc3QubGVuZ3RoICsgcmVxdWVzdExpc3QubGVuZ3RoID09PSB0aGlzLmRhdGEubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1lcmdlUmVxdWVzdCgpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiB1cGxvYWRDaHVua3MoKSB7CiAgICAgICAgcmV0dXJuIF91cGxvYWRDaHVua3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHVwbG9hZENodW5rczsKICAgIH0oKSwKICAgIG1lcmdlUmVxdWVzdDogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX21lcmdlUmVxdWVzdCA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KHsKICAgICAgICAgICAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL21lcmdlJywKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgIHNpemU6IFNJWkUsCiAgICAgICAgICAgICAgICAgICAgZmlsZUhhc2g6IHRoaXMuY29udGFpbmVyLmhhc2gsCiAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6IHRoaXMuY29udGFpbmVyLmZpbGUubmFtZQogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5LiK5Lyg5oiQ5YqfJyk7CiAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFN0YXR1cy53YWl0OwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBtZXJnZVJlcXVlc3QoKSB7CiAgICAgICAgcmV0dXJuIF9tZXJnZVJlcXVlc3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG1lcmdlUmVxdWVzdDsKICAgIH0oKSwKICAgIHZlcmlmeVVwbG9hZDogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3ZlcmlmeVVwbG9hZCA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KGZpbGVuYW1lLCBmaWxlSGFzaCkgewogICAgICAgIHZhciBfcmVmOSwgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoewogICAgICAgICAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvdmVyaWZ5JywKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICBmaWxlSGFzaDogZmlsZUhhc2gKICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBfcmVmOSA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF9yZWY5LmRhdGE7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgSlNPTi5wYXJzZShkYXRhKSk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHZlcmlmeVVwbG9hZChfeDIsIF94MykgewogICAgICAgIHJldHVybiBfdmVyaWZ5VXBsb2FkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB2ZXJpZnlVcGxvYWQ7CiAgICB9KCkKICB9Cn07"},{"version":3,"sources":["Upload.vue"],"names":[],"mappings":"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","sourcesContent":["<!--\n * @Descripttion: 上传\n * @Author: yanxu gong\n * @Date: 2020-01-26 20:52:05\n * @LastEditors  : yanxu gong\n * @LastEditTime : 2020-02-13 12:06:06\n -->\n<template>\n  <div>\n    <div class=\"upload\">\n      <input\n        type=\"file\"\n        :disabled=\"status !== Status.wait\"\n        @change=\"handleFileChange\"\n      />\n      <el-button @click=\"handleUpload\" :disabled=\"uploadDisabled\"\n        >上传</el-button\n      >\n      <el-button @click=\"handleResume\" v-if=\"status === Status.pause\"\n        >恢复</el-button\n      >\n      <el-button\n        v-else\n        @click=\"handlePause\"\n        :disabled=\"status !== Status.uploading || !container.hash\"\n        >暂停</el-button\n      >\n    </div>\n    <div>\n      <div>计算文件 hash</div>\n      <el-progress :percentage=\"hashPercentage\"></el-progress>\n      <div>总进度</div>\n      <el-progress :percentage=\"fakeUploadPercentage\"></el-progress>\n    </div>\n    <el-table :data=\"data\">\n      <el-table-column\n        prop=\"hash\"\n        label=\"切片hash\"\n        align=\"center\"\n      ></el-table-column>\n      <el-table-column label=\"大小(KB)\" align=\"center\" width=\"120\">\n        <template v-slot=\"{ row }\">\n          {{ row.size | transformByte }}\n        </template>\n      </el-table-column>\n      <el-table-column label=\"进度\" align=\"center\">\n        <template v-slot=\"{ row }\">\n          <el-progress\n            :percentage=\"row.percentage\"\n            color=\"#909399\"\n          ></el-progress>\n        </template>\n      </el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script>\nconst SIZE = 10 * 1024 * 1024 // 切片大小\n\nconst Status = {\n  wait: 'wait',\n  pause: 'pause',\n  uploading: 'uploading'\n}\n\nexport default {\n  filters: {\n    transformByte(val) {\n      return Number((val / 1024).toFixed(0))\n    }\n  },\n  data: () => ({\n    Status,\n    container: {\n      file: null,\n      hash: '',\n      worker: null\n    },\n    hashPercentage: 0,\n    data: [],\n    requestList: [],\n    status: Status.wait,\n    // 当暂停时会取消 xhr 导致进度条后退\n    // 为了避免这种情况，需要定义一个假的进度条\n    fakeUploadPercentage: 0\n  }),\n  watch: {\n    uploadPercentage(newValue) {\n      if (newValue > this.fakeUploadPercentage) {\n        this.fakeUploadPercentage = newValue\n      }\n    }\n  },\n  computed: {\n    uploadDisabled() {\n      return (\n        !this.container.file ||\n        [Status.pause, Status.uploading].includes(this.status)\n      )\n    },\n    uploadPercentage() {\n      if (!this.container.file || !this.data.length) return 0\n      const loaded = this.data\n        .map(item => item.size * item.percentage)\n        .reduce((acc, cur) => acc + cur)\n      return parseInt((loaded / this.container.file.size).toFixed(2))\n    }\n  },\n  methods: {\n    handlePause() {\n      this.status = Status.pause\n      this.resetData()\n    },\n    resetData() {\n      this.requestList.forEach(xhr => xhr?.abort())\n      this.requestList = []\n      if (this.container.worker) {\n        this.container.worker.onmessage = null\n      }\n    },\n    request({\n      url,\n      method = 'post',\n      data,\n      headers = {},\n      onProgress = e => e,\n      requestList\n    }) {\n      return new Promise(resolve => {\n        const xhr = new XMLHttpRequest()\n        xhr.upload.onprogress = onProgress\n        xhr.open(method, url)\n        Object.keys(headers).forEach(key =>\n          xhr.setRequestHeader(key, headers[key])\n        )\n        xhr.send(data)\n        xhr.onload = e => {\n          // 将请求成功的 xhr 从列表中删除\n          if (requestList) {\n            const xhrIndex = requestList.findIndex(item => item === xhr)\n            requestList.splice(xhrIndex, 1)\n          }\n          resolve({\n            data: e.target.response\n          })\n        }\n        // 暴露当前 xhr 给外部\n        requestList && requestList.push(xhr)\n      })\n    },\n    // 生成文件切片\n    createFileChunk(file, size = SIZE) {\n      const fileChunkList = []\n      let sum = 0\n      // 当满足条件时进入循环，进入循环后，当条件不满足时，跳出循环\n      while (sum < file.size) {\n        fileChunkList.push({ file: file.slice(sum, sum + size) })\n        sum += size\n      }\n      return fileChunkList\n    },\n    // 生成文件 hash (web-worker)\n    calculateHash(fileChunkList) {\n      debugger\n      return new Promise(resolve => {\n        // 添加 worker 属性\n        this.container.worker = new Worker('/hash.js')\n        this.container.worker.postMessage({ fileChunkList })\n        this.container.worker.onmessage = e => {\n          const { percentage, hash } = e.data\n          this.hashPercentage = percentage\n          if (hash) {\n            resolve(hash)\n          }\n        }\n      })\n    },\n    handleFileChange(e) {\n      const [file] = e.target.files\n      if (!file) return\n      this.resetData()\n      // 将当前状态的data重置为初始状态\n      Object.assign(this.$data, this.$options.data())\n      this.container.file = file\n    },\n    createProgressHandler(item) {\n      return e => {\n        item.percentage = parseInt(String((e.loaded / e.total) * 100))\n      }\n    },\n    async handleResume() {\n      this.status = Status.uploading\n      const { uploadedList } = await this.verifyUpload(\n        this.container.file.name,\n        this.container.hash\n      )\n      await this.uploadChunks(uploadedList)\n    },\n    async handleUpload() {\n      debugger\n      if (!this.container.file) return\n      this.status = Status.uploading\n      const fileChunkList = this.createFileChunk(this.container.file)\n      this.container.hash = await this.calculateHash(fileChunkList)\n\n      const { shouldUpload, uploadedList } = await this.verifyUpload(\n        this.container.file.name,\n        this.container.hash\n      )\n      if (!shouldUpload) {\n        this.$message.success('秒传：上传成功')\n        this.status = Status.wait\n        return\n      }\n\n      this.data = fileChunkList.map(({ file }, index) => ({\n        fileHash: this.container.hash,\n        index,\n        hash: `${this.container.file.name}-${index}`, // 文件名 + 数组下标\n        chunk: file,\n        size: file.size,\n        percentage: uploadedList.includes(index) ? 100 : 0\n      }))\n\n      await this.uploadChunks(uploadedList)\n    },\n    // 上传切片\n    async uploadChunks(uploadedList = []) {\n      const requestList = this.data\n        .filter(({ hash }) => !uploadedList.includes(hash))\n        .map(({ chunk, hash, index }) => {\n          const formData = new FormData()\n          formData.append('chunk', chunk)\n          formData.append('hash', hash)\n          formData.append('filename', this.container.file.name)\n          formData.append('fileHash', this.container.hash)\n          return { formData, index }\n        })\n        .map(async ({ formData, index }) =>\n          this.request({\n            url: 'http://localhost:3000',\n            data: formData,\n            onProgress: this.createProgressHandler(this.data[index]),\n            requestList: this.requestList\n          })\n        )\n      await Promise.all(requestList) // 并发切片\n      // 之前上传的切片数量 + 本次上传的切片数量 = 所有切片数量时\n      // 合并切片\n      if (uploadedList.length + requestList.length === this.data.length) {\n        await this.mergeRequest()\n      }\n    },\n    async mergeRequest() {\n      // debugger\n      await this.request({\n        url: 'http://localhost:3000/merge',\n        headers: { 'content-type': 'application/json' },\n        data: JSON.stringify({\n          size: SIZE,\n          fileHash: this.container.hash,\n          filename: this.container.file.name\n        })\n      })\n      this.$message.success('上传成功')\n      this.status = Status.wait\n    },\n    async verifyUpload(filename, fileHash) {\n      const { data } = await this.request({\n        url: 'http://localhost:3000/verify',\n        headers: { 'content-type': 'application/json' },\n        data: JSON.stringify({\n          filename,\n          fileHash\n        })\n      })\n      return JSON.parse(data)\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views"}]}